

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Full docker documentation &mdash; Documentation  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Wlcome to my Documentation’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Full docker documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#docker-definition">Docker definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dockerfile-instruction">Dockerfile instruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-process">Docker process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-important">Docker important</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-naming">Docker naming</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-flags">Docker flags</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-commands">Docker commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dockerfile-examples">Dockerfile examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hello">Hello</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Full docker documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/docker.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="full-docker-documentation">
<h1>Full docker documentation<a class="headerlink" href="#full-docker-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="docker-definition">
<h2>Docker definition<a class="headerlink" href="#docker-definition" title="Permalink to this headline">¶</a></h2>
<p>Docker daemon - сервер, работающий в фоновом режиме на хост-машине и умеющий скачивать, заливать образы, заливать из них контейнеры, следить за запущенными контейнерами, собирать логи, настраивать сеть между контейнерами. Кроме того, именно он создет образы контейнеров.</p>
<p>Docker - утилита для управления Docker daemon по HTTP. При сборке образа docker принимает пассивное участие, архивирует папку и передает по сети демону, который выполняет всю работу, поэтому лучше собирать тяжелые образы локально.</p>
<p>Docker Hub - хранение контейнеров.</p>
<p>Docker image - компонента сборки docker.</p>
<p>Docker container - все, что нужно для работы приложения, каждый контейнер изолирован и является безопасной платформой для приложения.</p>
<p>Docker volume - файлы или директории, которые смонтированы на хосте и не являются частью UFS</p>
<p>cgroups - контроль ресурсов, которые использует контейнер, например, память и CPU. Они так же ответственны за заморозку и разморозку контейнеров</p>
<p>namespaces - изолирование контейнеров</p>
<p>Swarm - группировка нескольких docker хостов, позволяющих обращаться к ним как к унифицированному ресурсу.</p>
<p>Compose - создание и запуск приложения, собранного из несколько Docker контейнеров</p>
<p>Machine - установка и конфигурирование Docker хостов на локальных или удаленных устройствах</p>
</div>
<div class="section" id="dockerfile-instruction">
<h2>Dockerfile instruction<a class="headerlink" href="#dockerfile-instruction" title="Permalink to this headline">¶</a></h2>
<p>ADD - копирует файлы в образ. Архив будет автоматически распакован. Сильно сложнее, нежеди простое COPY, поэтому лучше  всего использовать именно COPY.</p>
<p>CMD - запускает данную инструкцию, когда контейнер запущен. Если определен ENTRYPOINT, то данная инструкция воспринимается как аргументы к ENTRYPOINT. CMD инструкция переопределяется</p>
<p>COPY - копирование файлов [“src”, “dest”], src - откуда, dest - куда.</p>
<p>ENTRYPOINT - установка исполняемого файло для запуска при запуске контейнера. ENTRYPOINT инструкция часто используется для обеспечения стартового скрипта, который инициализирует переменные и сервисы перед интрепретацией любых заданных аргументов</p>
<p>ENV - определение переменных величин.</p>
<p>EXPOSE - определяет порт или порты, который буддут слушать данный контейнер. Часто эта информация используется во время соединения контейнеров или публикации портов с помощью поставки -P аргумента к команде docker run.</p>
<p>FROM - настраивает базовый образ докерфайла</p>
<p>MAINTAINER - владелец.</p>
<p>ONBUILD - определяет игструкцию, которая будет использована позже, когда образ используется в качестве базового слоя к другому образу. Это может быть полезно для обработки данных, которые будут добавлены в child images (например, код копирования данных в выбранные директории и скрипт по преобразованию этих данных)</p>
<p>RUN - запуск инструкций внутри контейнера и коммит результата</p>
<p>USER - настраивает пользователя для использования инструкций RUN, CMD, ENTRYPOINT</p>
<p>VOLUME - объявляет специальные файлы или директории в качестве volume. Если папка или директория уже существует в образе, то она будет скопирована в volume, когда контейнер стартует</p>
<p>WORKDIR - настраивает рабочую директорию для следующих инструкций RUN, CMD, ENTRYPOINT, ADD, COPY, может использоваться несколько раз, указанные пути могут использоваться и переопределяться к связанным предыдущим рабочим директориям</p>
</div>
<div class="section" id="docker-process">
<h2>Docker process<a class="headerlink" href="#docker-process" title="Permalink to this headline">¶</a></h2>
<p>Команда <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">docker</span> <span class="pre">run</span> <span class="pre">-it</span> <span class="pre">ubuntu</span> <span class="pre">/bin/bash</span></code></p>
<ol class="arabic simple">
<li><p>Скачивает образ ubuntu.</p></li>
<li><p>Создает контейнер.</p></li>
<li><p>Инициализирует сутьмост - позволяет обшаться докеру с хост машиной</p></li>
<li><p>Устанавливает IP адрес</p></li>
<li><p>Запускает указанный процесс</p></li>
<li><p>Обрабатывает и выдает вывод приложения</p></li>
</ol>
</div>
<div class="section" id="docker-important">
<h2>Docker important<a class="headerlink" href="#docker-important" title="Permalink to this headline">¶</a></h2>
<p>Docker использует объединенную файловую систему (union filesystem) для контейнеров, что позволяет монтировать несколько файловых систем в порядке иерархии и появляться в качестве единой системы.  Файловая система образа монтируется как read-only слой и любые изменения запущенного контейнера приводят к измненеию последующих</p>
<p>Чтобы все быстрее собиралось можно использовать .dockerignorefile, который может включать в себя файлы на подобие</p>
<blockquote>
<div><ul class="simple">
<li><p>.git (в корневой директории)</p></li>
<li><p>*/.git (только в директории на один ниже корня)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="docker-naming">
<h2>Docker naming<a class="headerlink" href="#docker-naming" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>author/name -принадлежат пользователю</p></li>
<li><p>name - общие подтвержденные</p></li>
<li><p>localhost:5000/name - развернуты на определенном сервере</p></li>
</ol>
</div>
<div class="section" id="docker-flags">
<h2>Docker flags<a class="headerlink" href="#docker-flags" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">-a,</span> <span class="pre">-attach</span></code> - прикрепляет данный стрим в терминал</p>
<p><code class="docutils literal notranslate"><span class="pre">-d,</span> <span class="pre">-detach</span></code> - запуск контенйера на фоне</p>
<p><code class="docutils literal notranslate"><span class="pre">-i,</span> <span class="pre">--interactive</span></code> - сохраняет stdin открытым, обычно используется с <code class="docutils literal notranslate"><span class="pre">-t</span></code> чтобы начать интерактивную сессию с контейнером</p>
<p><code class="docutils literal notranslate"><span class="pre">--restart</span></code> - определяет количество раз рестарта, пример применения - <code class="docutils literal notranslate"><span class="pre">--restart</span> <span class="pre">on-failure:10</span> <span class="pre">postgres</span></code> - запускает контейнер постгреса и пытается рестаровать 10 раз если случается ошибка</p>
<p><code class="docutils literal notranslate"><span class="pre">--rm</span></code> - удаляет контейнер, если он существует. Не может использоваться с <code class="docutils literal notranslate"><span class="pre">-d</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">-e,</span> <span class="pre">--env</span></code> - задание переменных окружения внутри контейнера, пример использования <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">docker</span> <span class="pre">tun</span> <span class="pre">-e</span> <span class="pre">var1-val</span> <span class="pre">-e</span> <span class="pre">var2=&quot;val</span> <span class="pre">2&quot;</span> <span class="pre">debian</span> <span class="pre">env</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--hostname</span></code> - определяет имя хоста</p>
<p><code class="docutils literal notranslate"><span class="pre">--expose</span></code> - эквивалентно EXPOSE в докерфайле, определяет порт, используемый контейнером, но не открывает его.</p>
<p><code class="docutils literal notranslate"><span class="pre">-p,</span> <span class="pre">--publish</span></code> - публикация порта контейнера, делает кго доступным с хоста.</p>
<p><code class="docutils literal notranslate"><span class="pre">--entrypoint</span></code> - устанавливает entrypoint для контейнера с заданными аргументами, переопределяет ENTRYPOINT инструкцию в докерфайле</p>
<p><code class="docutils literal notranslate"><span class="pre">-d</span></code> - запуск контейнера в фоновом режиме</p>
<p><code class="docutils literal notranslate"><span class="pre">-n</span></code>, <code class="docutils literal notranslate"><span class="pre">--name</span></code> - задание имени контейнера</p>
<p><code class="docutils literal notranslate"><span class="pre">--link</span></code> - соеднинение двух контейнеров</p>
<p><code class="docutils literal notranslate"><span class="pre">-v</span></code> - название volume</p>
<p><code class="docutils literal notranslate"><span class="pre">--no-cache</span></code> - запуск без кеширования</p>
<p><code class="docutils literal notranslate"><span class="pre">-P</span></code> - выбор произвольного порта при запуске контейнера</p>
<p><code class="docutils literal notranslate"><span class="pre">-p</span></code> - выбор указанного порта при запуске контейнера</p>
<p><code class="docutils literal notranslate"><span class="pre">-icc=false</span> <span class="pre">and</span> <span class="pre">--iptables</span></code> - контейнера нельзя подсоединять к другим</p>
<p><code class="docutils literal notranslate"><span class="pre">-v</span></code> - флаг с volume, при удалении контейнера удаляет и volume</p>
</div>
<div class="section" id="docker-commands">
<h2>Docker commands<a class="headerlink" href="#docker-commands" title="Permalink to this headline">¶</a></h2>
<p>Доступ к командной строке внутри контейнера</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker run -it container_name /bin/bash
</pre></div>
</div>
<p>Получение полной информации о контейнере</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker inspect container_name
</pre></div>
</div>
<p>Получение списка измененных файлов в контейнере</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker diff container_name
</pre></div>
</div>
<p>Получение списка логов</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker logs container_name
</pre></div>
</div>
<p>Сохранение в образ из какого-то базового образа</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker commit base_image__name image_name
</pre></div>
</div>
<p>Связка двух контейнеров</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker run -d -P --name web --link db:db training/webapp python app.py
</pre></div>
</div>
<p>При этом –link name:alias.name, alias - имя под которым этот контейнер будет известен запускаемому
Это приводит к тому, что в контейнере web появится набор переменных окружения, указывающих на контейнер db + в /etc/hosts контейнера web появится алиас db указывающий на ip, на котором запустили контейнер с базой данных.</p>
<p>Определение volume и указание папки на хосте</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker run -it --name container-test -h CONtAINER -v /data debian /bin/bash
<span class="gp">$</span> docker run -v /home/data:/data debian ls /data
</pre></div>
</div>
<p>Attach команда позволяет пользователям просматривать или взаимодействовать с основным процеммом внутри контейнера</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker attach <span class="nv">$ID</span>
</pre></div>
</div>
<p>Create команда создает контейнер из образа, но не запускает его. Принимает ровно те же аргументы, что и docker run.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker create image
</pre></div>
</div>
<p>Cp копирует файлы и директории между контейнером и хостом</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker cp
</pre></div>
</div>
<p>Exec запускает команды внутри контейнера, по сути замена ssh для входа в контейнер</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker <span class="nb">exec</span> -it <span class="nb">echo</span> <span class="s2">&quot;Hello&quot;</span>
</pre></div>
</div>
<p>Kill - отправялет сигнал главному процессу в контейнер, по дефолту отправляет сигнал, который убивает контейнер.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker <span class="nb">kill</span> -s SIGRAP container_id
<span class="gp">$</span> docker <span class="nb">kill</span> container_id
</pre></div>
</div>
<p>Pause - приостанавливает все процессы внутри данного контейнера, перезапускается с помощью unpause</p>
<p>Top - обеспечивает информацию о запущенных процессах внутри контейнера.</p>
<p>tag - связывает репозиторий и имя тега образа</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> docker tag newname:latest name/newname:latest
</pre></div>
</div>
</div>
<div class="section" id="dockerfile-examples">
<h2>Dockerfile examples<a class="headerlink" href="#dockerfile-examples" title="Permalink to this headline">¶</a></h2>
<p>Примеры с volume. Надо отметить, что все инструкции после VOLUME инструкции не могут изменять этот volume</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">FROM debian:wheezy</span>
<span class="go">VOLUME /data</span>
</pre></div>
</div>
<p>Пример, когда команды не сработают</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">FROM debian:wheezy</span>
<span class="go">RUN useradd foo</span>
<span class="go">VOLUME /data</span>
<span class="go">RUN touch /data/x</span>
<span class="go">RUN chown -R foo:foo /data</span>
</pre></div>
</div>
<p>Пример, когда сработает как надо</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">FROM debian:wheezy</span>
<span class="go">RUN useradd foo</span>
<span class="go">RUN mkdir /data &amp;&amp; touch /data/x</span>
<span class="go">RUN chown -R foo:foo /data</span>
<span class="go">VOLUME /data</span>
</pre></div>
</div>
<div class="section" id="hello">
<h3>Hello<a class="headerlink" href="#hello" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Wlcome to my Documentation’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, NK Documentation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>